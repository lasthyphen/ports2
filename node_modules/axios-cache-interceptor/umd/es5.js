!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AxiosCacheInterceptor=t():e.AxiosCacheInterceptor=t()}("undefined"!=typeof self?self:this,(function(){return function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Header:function(){return i},buildKeyGenerator:function(){return T},buildMemoryStorage:function(){return A},buildStorage:function(){return C},buildWebStorage:function(){return L},canStale:function(){return S},createCacheResponse:function(){return v},createValidateStatus:function(){return f},defaultHeaderInterpreter:function(){return s},defaultKeyGenerator:function(){return M},defaultRequestInterceptor:function(){return g},defaultResponseInterceptor:function(){return y},isExpired:function(){return I},isMethodIn:function(){return h},isStorage:function(){return x},setupCache:function(){return P},testCachePredicate:function(){return m},updateCache:function(){return b},updateStaleRequest:function(){return p}});const r=Symbol("cache-parser");function n(e){return("string"==typeof e||"number"==typeof e)&&(e=Number(e))>=0&&e<1/0}function a(e){return!0===e||"number"==typeof e||"string"==typeof e&&"false"!==e}const o=Number;var i=Object.freeze({IfModifiedSince:"if-modified-since",LastModified:"last-modified",IfNoneMatch:"if-none-match",CacheControl:"cache-control",ETag:"etag",Expires:"expires",Age:"age",XAxiosCacheEtag:"x-axios-cache-etag",XAxiosCacheLastModified:"x-axios-cache-last-modified",XAxiosCacheStaleIfError:"x-axios-cache-stale-if-error"}),s=function(e){if(!e)return"not enough headers";var t=e[i.CacheControl];if(t){var s=function(e){const t=Object.defineProperty({},r,{enumerable:!1,value:1});if(!e||"string"!=typeof e)return t;const i=function(e){const t={},r=e.toLowerCase().replace(/\s+/g,"").split(",");for(const e in r){var n;const a=r[e].split("=",2);t[a[0]]=null==(n=a[1])||n}return t}(e),s=i["max-age"],c=i["max-stale"],u=i["min-fresh"],d=i["s-maxage"],l=i["stale-if-error"],f=i["stale-while-revalidate"];return a(i.immutable)&&(t.immutable=!0),n(s)&&(t.maxAge=o(s)),n(c)&&(t.maxStale=o(c)),n(u)&&(t.minFresh=o(u)),a(i["must-revalidate"])&&(t.mustRevalidate=!0),a(i["must-understand"])&&(t.mustUnderstand=!0),a(i["no-cache"])&&(t.noCache=!0),a(i["no-store"])&&(t.noStore=!0),a(i["no-transform"])&&(t.noTransform=!0),a(i["only-if-cached"])&&(t.onlyIfCached=!0),a(i.private)&&(t.private=!0),a(i["proxy-revalidate"])&&(t.proxyRevalidate=!0),a(i.public)&&(t.public=!0),n(d)&&(t.sMaxAge=o(d)),n(l)&&(t.staleIfError=o(l)),n(f)&&(t.staleWhileRevalidate=o(f)),t}(String(t)),c=s.noCache,u=s.noStore,d=s.mustRevalidate,l=s.maxAge,f=s.immutable;if(c||u)return"dont cache";if(f)return 31536e6;if(d)return 0;if(l){var h=e[i.Age];return h?1e3*(l-Number(h)):1e3*l}}var p=e[i.Expires];if(p){var v=Date.parse(String(p))-Date.now();return v>=0?v:"dont cache"}return"not enough headers"};var c=function(){return c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},c.apply(this,arguments)};function u(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))}function d(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;Object.create;const l=Symbol();function f(e){return e?function(t){return e(t)||304===t}:function(e){return e>=200&&e<300||304===e}}function h(e,t){void 0===e&&(e="get"),void 0===t&&(t=[]),e=e.toLowerCase();for(var r=0,n=t;r<n.length;r++){if(n[r].toLowerCase()===e)return!0}return!1}function p(e,t){var r;t.headers||(t.headers={});var n=t.cache,a=n.etag,o=n.modifiedSince;if(a){var s=!0===a?null===(r=e.data)||void 0===r?void 0:r.headers[i.ETag]:a;s&&(t.headers[i.IfNoneMatch]=s)}o&&(t.headers[i.IfModifiedSince]=!0===o?e.data.headers[i.LastModified]||new Date(e.createdAt).toUTCString():o.toUTCString())}function v(e,t){return 304===e.status&&t?(e.cached=!0,e.data=t.data,e.status=t.status,e.statusText=t.statusText,e.headers=c(c({},t.headers),e.headers),t):{data:e.data,status:e.status,statusText:e.statusText,headers:e.headers}}function g(e){var t=this,r=function(r){return u(t,void 0,void 0,(function(){var t,n,a,o,i;return d(this,(function(s){switch(s.label){case 0:return!1===r.cache?[2,r]:(r.cache=c(c({},e.defaults.cache),r.cache),h(r.method,r.cache.methods)?(t=r.id=e.generateKey(r),[4,e.storage.get(t)]):[2,r]);case 1:return"empty"!==(n=s.sent()).state&&"stale"!==n.state?[3,5]:e.waiting[t]?[4,e.storage.get(t)]:[3,3];case 2:return n=s.sent(),[3,5];case 3:return e.waiting[t]=function(){let e,t;const r=new Promise(((r,n)=>{e=r,t=n}));return r.resolve=e,r.reject=t,r[l]=1,r}(),null===(i=e.waiting[t])||void 0===i||i.catch((function(){})),[4,e.storage.set(t,{state:"loading",previous:n.state,data:n.data,createdAt:n.createdAt})];case 4:return s.sent(),"stale"===n.state&&p(n,r),r.validateStatus=f(r.validateStatus),[2,r];case 5:return"loading"!==n.state?[3,12]:(o=e.waiting[t])?[3,7]:[4,e.storage.remove(t)];case 6:return s.sent(),[2,r];case 7:0,s.label=8;case 8:return s.trys.push([8,10,,11]),[4,o];case 9:return a=s.sent(),[3,11];case 10:return s.sent(),[2,r];case 11:return[3,13];case 12:a=n.data,s.label=13;case 13:return r.adapter=function(){return Promise.resolve({config:r,data:a.data,headers:a.headers,status:a.status,statusText:a.statusText,cached:!0,id:t})},[2,r]}}))}))};return{onFulfilled:r,apply:function(){return e.interceptors.request.use(r)}}}function m(e,t){var r;return u(this,void 0,void 0,(function(){var n,a,o,i,s,c,u,l,f,h,p,v;return d(this,(function(d){switch(d.label){case 0:return"function"==typeof t?[2,t(e)]:(n=t.statusCheck,a=t.responseMatch,o=t.containsHeaders,(s=n)?[4,n(e.status)]:[3,2]);case 1:s=!d.sent(),d.label=2;case 2:return(i=s)?[3,5]:(c=a)?[4,a(e)]:[3,4];case 3:c=!d.sent(),d.label=4;case 4:i=c,d.label=5;case 5:if(i)return[2,!1];if(!o)return[3,10];for(l in u=[],o)u.push(l);f=0,d.label=6;case 6:return f<u.length?(h=u[f],p=o[h],(v=p)?[4,p(null!==(r=e.headers[h.toLowerCase()])&&void 0!==r?r:e.headers[h])]:[3,8]):[3,10];case 7:v=!d.sent(),d.label=8;case 8:if(v)return[2,!1];d.label=9;case 9:return f++,[3,6];case 10:return[2,!0]}}))}))}function b(e,t,r){return u(this,void 0,void 0,(function(){var n,a,o,i,s,c,u;return d(this,(function(d){switch(d.label){case 0:for(a in n=[],r)n.push(a);o=0,d.label=1;case 1:return o<n.length?(i=n[o],"delete"!==(s=r[i])?[3,3]:[4,e.remove(i)]):[3,10];case 2:return d.sent(),[3,9];case 3:return[4,e.get(i)];case 4:return"loading"===(c=d.sent()).state?[3,9]:[4,s(c,t)];case 5:return"delete"!==(u=d.sent())?[3,7]:[4,e.remove(i)];case 6:return d.sent(),[3,9];case 7:return"ignore"===u?[3,9]:[4,e.set(i,u)];case 8:d.sent(),d.label=9;case 9:return o++,[3,1];case 10:return[2]}}))}))}function y(e){var t=this,r=function(r){return u(t,void 0,void 0,(function(){var t;return d(this,(function(n){switch(n.label){case 0:return[4,e.storage.remove(r)];case 1:return n.sent(),null===(t=e.waiting[r])||void 0===t||t.reject(null),delete e.waiting[r],[2]}}))}))},n=function(n){return u(t,void 0,void 0,(function(){var t,a,o,s,u,l,f,h,p,g,y,w;return d(this,(function(d){switch(d.label){case 0:return n.id=null!==(g=(w=n.config).id)&&void 0!==g?g:w.id=e.generateKey(n.config),null!==(y=n.cached)&&void 0!==y||(n.cached=!1),n.cached?[2,n]:n.config.cache?(t=n.config.cache,[4,e.storage.get(n.id)]):[2,c(c({},n),{cached:!1})];case 1:return"stale"===(a=d.sent()).state||"empty"===a.state||"cached"===a.state?[2,n]:(o=!a.data)?[4,m(n,t.cachePredicate)]:[3,3];case 2:o=!d.sent(),d.label=3;case 3:return o?[4,r(n.id)]:[3,5];case 4:return d.sent(),[2,n];case 5:for(s in i)s.startsWith("XAxiosCache")&&delete n.headers[s];return t.etag&&!0!==t.etag&&(n.headers[i.XAxiosCacheEtag]=t.etag),t.modifiedSince&&(n.headers[i.XAxiosCacheLastModified]=!0===t.modifiedSince?"use-cache-timestamp":t.modifiedSince.toUTCString()),u=t.ttl||-1,(null==t?void 0:t.interpretHeader)?"dont cache"!==(l=e.headerInterpreter(n.headers))?[3,7]:[4,r(n.id)]:[3,8];case 6:return d.sent(),[2,n];case 7:u="not enough headers"===l?u:l,d.label=8;case 8:return f=v(n,a.data),"function"!=typeof u?[3,10]:[4,u(n)];case 9:u=d.sent(),d.label=10;case 10:return t.staleIfError&&(n.headers[i.XAxiosCacheStaleIfError]=String(u)),(null==t?void 0:t.update)?[4,b(e.storage,n,t.update)]:[3,12];case 11:d.sent(),d.label=12;case 12:return h={state:"cached",ttl:u,createdAt:Date.now(),data:f},(p=e.waiting[n.id])&&(p.resolve(h.data),delete e.waiting[n.id]),[4,e.storage.set(n.id,h)];case 13:return d.sent(),[2,n]}}))}))},a=function(n){return u(t,void 0,void 0,(function(){var t,a,o,i,s,c;return d(this,(function(u){switch(u.label){case 0:if(!(t=n.config)||!1===t.cache||!t.id)throw n;return[4,e.storage.get(t.id)];case 1:return a=u.sent(),o=t.cache,"loading"===a.state&&"stale"===a.previous?[3,3]:[4,r(t.id)];case 2:throw u.sent(),n;case 3:return(null==o?void 0:o.staleIfError)?"function"!=typeof o.staleIfError?[3,5]:[4,o.staleIfError(n.response,a,n)]:[3,8];case 4:return s=u.sent(),[3,6];case 5:s=o.staleIfError,u.label=6;case 6:return!0===(i=s)||"number"==typeof i&&a.createdAt+i>Date.now()?(null===(c=e.waiting[t.id])||void 0===c||c.resolve(a.data),delete e.waiting[t.id],[4,e.storage.set(t.id,{state:"stale",createdAt:Date.now(),data:a.data})]):[3,8];case 7:return u.sent(),[2,{cached:!0,config:t,id:t.id,data:a.data.data,headers:a.data.headers,status:a.data.status,statusText:a.data.statusText}];case 8:throw n}}))}))};return{onFulfilled:n,onRejected:a,apply:function(){return e.interceptors.response.use(n,a)}}}var w=Symbol(),x=function(e){return!!e&&!!e[w]};function S(e){var t=e.data.headers;return i.ETag in t||i.LastModified in t||i.XAxiosCacheEtag in t||i.XAxiosCacheStaleIfError in t||i.XAxiosCacheLastModified in t}function I(e){return e.createdAt+e.ttl<=Date.now()}function C(e){var t,r=this,n=e.set,a=e.find,o=e.remove;return(t={})[w]=1,t.set=n,t.remove=o,t.get=function(e){return u(r,void 0,void 0,(function(){var t,r;return d(this,(function(i){switch(i.label){case 0:return[4,a(e)];case 1:return(t=i.sent())?"cached"===t.state&&I(t)?S(t)?(r={state:"stale",createdAt:t.createdAt,data:t.data},[4,n(e,r)]):[3,3]:[2,t]:[2,{state:"empty"}];case 2:return i.sent(),[2,r];case 3:return[4,o(e)];case 4:return i.sent(),[2,{state:"empty"}]}}))}))},t}function A(){var e=C({find:function(t){return e.data[t]},set:function(t,r){e.data[t]=r},remove:function(t){delete e.data[t]}});return e.data=Object.create(null),e}function E(e){const t=typeof e;if(e&&"object"==t&&!(e instanceof Date||e instanceof RegExp)){const t=Array.isArray(e)?[]:{};for(const r in e)t[r]=E(e[r]);return`${e.constructor}${JSON.stringify(t,Object.keys(e).sort())}`}return`${t}${String(e)}`}function j(e){e=E(e);let t=5381,r=0;for(;r<e.length;)t=33*t^e.charCodeAt(r++);return t}var O=/^\/|\/$/g;function T(e){return function(t){if(t.id)return t.id;var r=e(t);return"".concat("string"==typeof r||"number"==typeof r?r:j(r))}}var M=T((function(e){var t=e.baseURL,r=void 0===t?"":t,n=e.url,a=void 0===n?"":n,o=e.method,i=void 0===o?"get":o,s=e.params,c=e.data;return r&&(r=r.replace(O,"")),a&&(a=a.replace(O,"")),i&&(i=i.toLowerCase()),{url:r+(r&&a?"/":"")+a,params:s,method:i,data:c}}));function P(e,t){var r,n,a,o,i;void 0===t&&(t={});var c=e;if(c.storage=t.storage||A(),!x(c.storage))throw new Error("Use buildStorage() function");return c.generateKey=t.generateKey||M,c.waiting=t.waiting||{},c.headerInterpreter=t.headerInterpreter||s,c.requestInterceptor=t.requestInterceptor||g(c),c.responseInterceptor=t.responseInterceptor||y(c),c.debug=t.debug,c.defaults.cache={ttl:null!==(r=t.ttl)&&void 0!==r?r:3e5,interpretHeader:null!==(n=t.interpretHeader)&&void 0!==n&&n,methods:t.methods||["get"],cachePredicate:t.cachePredicate||{statusCheck:function(e){return e>=200&&e<400}},etag:null!==(a=t.etag)&&void 0!==a&&a,modifiedSince:null!==(o=t.modifiedSince)&&void 0!==o&&o,staleIfError:null!==(i=t.staleIfError)&&void 0!==i&&i,update:t.update||{}},c.requestInterceptor.apply(),c.responseInterceptor.apply(),c}function L(e,t){return void 0===t&&(t=""),C({find:function(r){var n=e.getItem(t+r);return n?JSON.parse(n):void 0},remove:function(r){e.removeItem(t+r)},set:function(r,n){var a=function(){return e.setItem(t+r,JSON.stringify(n))};try{return a()}catch(n){for(var o=Object.entries(e).filter((function(r){var n=r[0];return n.startsWith(t)&&e.getItem(n)})).map((function(e){var t=e[0],r=e[1];return[t,JSON.parse(r)]})),i=0,s=o;i<s.length;i++){var c=s[i],u=c[0],d=c[1];"cached"===d.state&&I(d)&&!S(d)&&e.removeItem(u)}try{return a()}catch(t){for(var l=o.sort((function(e,t){var r=e[1],n=t[1];return(r.createdAt||0)-(n.createdAt||0)})),f=0,h=l;f<h.length;f++){u=h[f][0];e.removeItem(u);try{return a()}catch(e){}}}e.removeItem(t+r)}}})}return t}()}));